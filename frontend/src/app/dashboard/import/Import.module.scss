// =========================================
// VARIÁVEIS & BASES
// =========================================
$bg-dark: #0f172a;
$bg-card: #1e293b;
$border: #334155;
$primary: #3b82f6;
$success: #10b981;
$danger: #ef4444;
$text-main: #e2e8f0;
$text-muted: #94a3b8;

.container {
  padding: 2rem 3rem;
  margin: 0 auto;
  min-height: 100vh;
  background: $bg-dark;
  color: $text-main;
  box-sizing: border-box;

  @media (max-width: 768px) {
    padding: 1rem;
  }
}

// =========================================
// HEADER & NAVEGAÇÃO
// =========================================
.topNav {
  margin-bottom: 2rem;
}

.btnBack {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  color: $text-muted;
  text-decoration: none;
  font-size: 0.95rem;
  font-weight: 500;
  transition: all 0.2s ease;

  &:hover {
    color: #f8fafc;
    transform: translateX(-4px);
  }
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  margin-bottom: 1.5rem;
  flex-wrap: wrap;
  gap: 1.5rem;

  .headerTitle {
    h2 { margin: 0; font-size: 1.8rem; }
    span { color: $text-muted; font-size: 0.9rem; }
  }

  .actions {
    display: flex;
    gap: 1rem;
  }

  // Mobile: Botões empilhados
  @media (max-width: 768px) {
    flex-direction: column;
    align-items: flex-start;
    gap: 1rem;
    
    .actions {
      width: 100%;
      flex-direction: column;
      button { width: 100%; justify-content: center; }
    }
  }
}

// =========================================
// STEP 1: UPLOAD BOX
// =========================================
.uploadBox {
  background: $bg-card;
  border: 2px dashed $border;
  border-radius: 12px;
  padding: 5rem 2rem;
  text-align: center;
  margin-top: 2rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1.5rem;
  transition: border-color 0.2s;

  &:hover { border-color: $primary; }

  h2 { margin: 0; font-size: 1.5rem; }
  p { color: $text-muted; margin: 0; max-width: 400px; line-height: 1.5; }
  
  .loadingText { color: $primary; animation: pulse 1s infinite; }
  
  .btnFile {
    background: $primary;
    color: white;
    padding: 12px 24px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    display: inline-block;
    transition: background 0.2s;
    input { display: none; }
    &:hover { background: darken($primary, 10%); }
  }
}

// =========================================
// CARD DE SALDO (Balance)
// =========================================
.balanceCard {
  background: $bg-card;
  border: 1px solid $border;
  border-left: 4px solid $success;
  border-radius: 12px;
  padding: 1.5rem;
  margin-bottom: 2rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 2rem;
  box-shadow: 0 4px 6px -1px rgba(0,0,0,0.2);

  .balanceInfo {
    display: flex;
    flex-direction: column;
    gap: 4px;

    p {
      color: $text-muted;
      font-size: 0.85rem;
      text-transform: uppercase;
      font-weight: 600;
      margin: 0;
    }

    strong {
      color: #f8fafc;
      font-size: 2rem;
      font-weight: 700;
    }
  }

  .balanceCheck {
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    background: $bg-dark;
    padding: 12px 20px;
    border-radius: 8px;
    border: 1px solid $border;
    transition: all 0.2s ease;

    &:hover {
      border-color: $success;
      transform: translateY(-2px);
    }

    input[type="checkbox"] {
      width: 20px; height: 20px; accent-color: $success; cursor: pointer;
    }

    span { color: $text-main; font-size: 0.95rem; font-weight: 500; }
  }

  @media (max-width: 768px) {
    flex-direction: column;
    align-items: flex-start;
    gap: 1rem;
    .balanceCheck { width: 100%; justify-content: center; box-sizing: border-box; }
  }
}

// =========================================
// BARRA DE AÇÕES EM MASSA (Bulk Actions)
// =========================================
.bulkActionsBar {
  position: sticky;
  top: 1rem;
  z-index: 50;
  
  background: $bg-card;
  border: 1px solid $primary;
  border-radius: 12px;
  padding: 1rem 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
  
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1.5rem;
  animation: slideDown 0.3s ease;

  .bulkCount {
    color: $text-main;
    font-size: 0.95rem;
    strong { color: $primary; font-size: 1.1rem; }
  }

  .bulkControls {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;

    select {
      background: $bg-dark;
      border: 1px solid lighten($border, 10%);
      color: $text-main;
      padding: 10px 12px;
      border-radius: 6px;
      font-size: 0.9rem;
      cursor: pointer;
      min-width: 180px;
      &:focus { border-color: $primary; outline: none; }
    }

    .btnBulkDanger {
      background: rgba($danger, 0.2);
      color: $danger;
      border: 1px solid $danger;
      padding: 10px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      white-space: nowrap;
      &:hover { background: $danger; color: white; }
    }

    .btnBulkSec {
      background: transparent;
      color: $text-muted;
      border: 1px solid lighten($border, 10%);
      padding: 10px 16px;
      border-radius: 6px;
      cursor: pointer;
      white-space: nowrap;
      &:hover { background: $border; color: white; }
    }
  }

  .btnCloseBulk {
    background: none; border: none; color: $text-muted; font-size: 1.5rem; cursor: pointer;
    &:hover { color: white; }
  }

  @media (max-width: 1024px) {
    flex-direction: column; align-items: flex-start; padding: 1rem;
    .bulkControls {
      width: 100%; flex-direction: column; align-items: stretch;
      select, button { width: 100%; }
    }
    .btnCloseBulk { position: absolute; top: 10px; right: 10px; }
  }
}

// =========================================
// TABELA & RESPONSIVIDADE (CARD VIEW)
// =========================================
.tableWrapper {
  width: 100%;
  
  // Desktop Styles
  @media (min-width: 769px) {
    background: $bg-card;
    border: 1px solid $border;
    border-radius: 12px;
    overflow-x: auto;
    box-shadow: 0 4px 6px -1px rgba(0,0,0,0.2);
    
    &::-webkit-scrollbar { height: 8px; }
    &::-webkit-scrollbar-track { background: $bg-dark; border-radius: 0 0 12px 12px; }
    &::-webkit-scrollbar-thumb { background: $border; border-radius: 4px; }
  }
}

.table {
  width: 100%;
  border-collapse: collapse;

  // --- MODO DESKTOP ---
  @media (min-width: 769px) {
    min-width: 1000px; 

    th {
      background: $bg-dark;
      color: $text-muted;
      padding: 1rem;
      text-align: left;
      font-size: 0.85rem;
      text-transform: uppercase;
      border-bottom: 1px solid $border;
      white-space: nowrap;
    }

    td {
      padding: 0.8rem 1rem;
      border-bottom: 1px solid $border;
      vertical-align: middle;
      color: $text-main;
    }
  }

  // --- MODO MOBILE (Card Grid) ---
  @media (max-width: 768px) {
    display: block;
    thead { display: none; } // Esconde cabeçalho
    tbody { display: block; width: 100%; }

    tr {
      display: grid;
      // Coluna 1: 60px (Check/Icon/Data) | Coluna 2: Resto (Infos)
      grid-template-columns: 60px 1fr;
      
      background: $bg-card;
      border: 1px solid $border;
      border-radius: 12px;
      margin-bottom: 1rem;
      padding: 1rem;
      gap: 12px 16px; // Gap vertical e horizontal
      position: relative;
    }

    // -- COLUNA 1 (ESQUERDA) --
    
    // Checkbox
    td:nth-of-type(1) {
      grid-column: 1; grid-row: 1;
      border: none; padding: 0;
      display: flex; justify-content: center; align-items: center;
    }

    // Status (Lixeira/Ação)
    td:nth-of-type(2) {
      grid-column: 1; grid-row: 2;
      border: none; padding: 0;
      display: flex; justify-content: center; align-items: center;
      button { font-size: 1.4rem; padding: 8px; }
    }

    // Data (ocupa 2 linhas visuais para equilibrar)
    td:nth-of-type(3) {
      grid-column: 1; grid-row: 3 / span 2;
      border: none; padding: 8px 0 0 0;
      font-size: 0.85rem;
      color: $text-muted;
      text-align: center;
      display: flex; align-items: flex-start; justify-content: center;
    }

    // -- COLUNA 2 (DIREITA) --

    // Descrição
    td:nth-of-type(4) {
      grid-column: 2; grid-row: 1;
      border: none; padding: 0;
      input {
        font-weight: 600; font-size: 1rem; border: none; background: transparent;
        padding: 0; margin: 0; width: 100%;
        &:focus { background: $bg-dark; padding: 8px; border-radius: 4px; }
      }
    }

    // Valor
    td:nth-of-type(5) {
      grid-column: 2; grid-row: 2;
      border: none; padding: 0;
      font-size: 1.3rem; font-weight: 700;
      align-self: center;
    }

    // Categoria
    td:nth-of-type(6) {
      grid-column: 2; grid-row: 3;
      border: none; padding: 0;
      select { width: 100%; padding: 12px; } // Touch target maior
    }

    // Recorrência
    td:nth-of-type(7) {
      grid-column: 2; grid-row: 4;
      border: none; padding: 0;
      select { width: 100%; padding: 12px; }
    }
  }

  // Inputs Universais (Desktop e Mobile)
  input[type="text"], select {
    background: $bg-dark;
    border: 1px solid $border;
    color: $text-main;
    padding: 8px 10px;
    border-radius: 6px;
    width: 100%;
    font-size: 0.9rem;
    &:focus { outline: none; border-color: $primary; }
  }
}

// =========================================
// HELPERS & ESTADOS
// =========================================
.checkCell {
  text-align: center;
  input[type="checkbox"] {
    width: 18px; height: 18px; cursor: pointer; accent-color: $primary;
  }
}

.opaqueRow {
  background: darken($bg-card, 3%);
  opacity: 0.5;
  transition: all 0.3s;
  
  // No mobile, removemos a borda para ficar mais "apagado"
  @media (max-width: 768px) { border-color: transparent; }

  input[type="text"] {
    text-decoration: line-through;
    color: #64748b;
    pointer-events: none;
    border-color: transparent;
  }
  select { opacity: 0.5; pointer-events: none; border-color: transparent; }
}

.selectedRow {
  background: rgba($primary, 0.1) !important;
  td { border-bottom-color: $primary; }
  
  // Borda colorida no card mobile
  @media (max-width: 768px) { border-color: $primary; }
}

.recurrenceActive {
  border: 1px solid $primary !important;
  background: rgba($primary, 0.15) !important;
  color: lighten($primary, 20%) !important;
  font-weight: 600;
}

// Botões
.btnPri {
  background: $success; color: darken($success, 40%);
  border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer;
  white-space: nowrap;
  &:hover { background: darken($success, 5%); color: white; }
  &:disabled { background: $border; color: $text-muted; cursor: not-allowed; }
}

.btnSec {
  background: transparent; border: 1px solid $border; color: $text-main;
  padding: 12px 24px; border-radius: 8px; cursor: pointer; white-space: nowrap;
  &:hover { background: $border; }
}

.iconBtn {
  background: none; border: none; cursor: pointer; font-size: 1.2rem;
  padding: 8px; border-radius: 4px;
  &:hover { background: $border; }
}

// Animações
@keyframes pulse {
    0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; }
}
@keyframes slideDown {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}